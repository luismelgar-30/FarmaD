<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Chat IA - Farmacia Melgar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#0D6EFD',
                        'secondary-green': '#198754',
                        'accent-red': '#DC3545',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-gray-100 font-sans">
    <div class="max-w-3xl mx-auto mt-10 bg-white shadow-lg rounded-lg overflow-hidden">
        <div class="bg-primary-blue text-white p-4 text-xl font-bold text-center">
            Asistente IA - Farmacia Melgar
        </div>
        <div class="p-6 space-y-4">
            <div id="chat" class="space-y-3 max-h-[500px] overflow-y-auto border p-4 rounded-lg bg-gray-50">
                <div class="text-sm text-gray-600">
                     <strong>IA:</strong> Â¡Bienvenido a Farmacia Melgar! Â¿En quÃ© puedo ayudarte hoy?
                    <ul class="list-disc pl-5 mt-2">
                        <li>Escribe el nombre de tu medicamento para saber para quÃ© sirve, dosis, efectos, etc.</li>
                        <li>Escribe acerca de nosotros para mÃ¡s informaciÃ³n de la farmacia Melgar.</li>
                        <li>Indica tu malestar y te recomendaremos un medicamento.</li>
                    </ul>
                </div>
            </div>
            <div class="flex gap-2">
                <input id="user-input" type="text" class="flex-1 border rounded p-2" placeholder="Escribe tu pregunta...">
                <button onclick="sendMessage()" class="bg-primary-blue text-white px-4 rounded hover:bg-blue-600">Enviar</button>
            </div>
        </div>
    </div>

    <script>
        async function sendMessage() {
            const input = document.getElementById('user-input');
            const message = input.value.trim();
            if (!message) return;

            
            const chat = document.getElementById('chat');
            chat.innerHTML += `<div><strong>ðŸ§‘ TÃº:</strong> ${message}</div>`;
            input.value = '';

            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message })
                });

                const data = await response.json();

                if (data.reply) {
                    chat.innerHTML += `<div class="text-sm text-gray-700"><strong> IA:</strong> ${data.reply}</div>`;
                } else {
                    chat.innerHTML += `<div class="text-sm text-red-500"><strong>IA:</strong> No se pudo obtener respuesta.</div>`;
                }
            } catch (err) {
                console.error(err);
                chat.innerHTML += `<div class="text-sm text-red-500"><strong>IA:</strong> Error al conectar con el servidor.</div>`;
            }

            chat.scrollTop = chat.scrollHeight;
        }
    </script>
</body>
</html>
